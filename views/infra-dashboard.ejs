<%- include('partials/header', { active: 'infra-rooms' }) %>

<!-- Right Sidebar for School Filter -->
<aside id="sidebar" class="infra-sidebar">
  <div class="infra-sidebar-header">
    <h3>Filter by School</h3>
    <button class="sidebar-toggle-close" data-sidebar-toggle>
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </div>
  <div class="school-chips">
    <button class="school-chip palette-selected" data-school="all">
      <span class="chip-dot" style="background:#94a3b8;"></span> All Schools
    </button>
    <button class="school-chip" data-school="default">
      <span class="chip-dot" style="background:#342b7c;"></span> Elective
    </button>
    <button class="school-chip" data-school="7">
      <span class="chip-dot" style="background:#e12a7b;"></span> ATLAS ISDI
    </button>
    <button class="school-chip" data-school="8">
      <span class="chip-dot" style="background:#009fe0;"></span> ATLAS ISME
    </button>
    <button class="school-chip" data-school="11">
      <span class="chip-dot" style="background:#ed1a3b;"></span> ATLAS INSOFE / UGDX
    </button>
    <button class="school-chip" data-school="16">
      <span class="chip-dot" style="background:#CC5500;"></span> ATLAS LAW
    </button>
  </div>

  <div class="infra-sidebar-actions">
    <a href="#" id="exportNavBtn" class="sidebar-action-link">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
      Export CSV
    </a>
  </div>
</aside>

<div class="p-[24px]">
  <!-- Header with stats -->
  <div class="flex flex-wrap justify-between items-center gap-[12px] mb-[24px]">
    <div>
      <h2 class="text-[1.5rem] font-[700] text-[#1e293b] mb-[2px]">Room Occupancy</h2>
      <p class="text-[0.85rem] text-[#64748b]">Gantt chart view of room schedules</p>
    </div>
    <div class="flex items-center gap-[12px] flex-shrink-0">
      <div class="flex gap-[16px] pr-[16px] border-r border-[#e2e8f0]">
        <div class="text-center">
          <div class="text-[1.25rem] font-[700] text-[#ef4444]" id="headerOccupied">0</div>
          <div class="text-[0.7rem] text-[#94a3b8] uppercase tracking-[0.05em]">Occupied</div>
        </div>
        <div class="text-center">
          <div class="text-[1.25rem] font-[700] text-[#10b981]" id="headerAvailable">0</div>
          <div class="text-[0.7rem] text-[#94a3b8] uppercase tracking-[0.05em]">Available</div>
        </div>
      </div>
      <button id="sidebarToggle" class="btn btn-secondary" style="font-family: var(--font-main); text-decoration: none; white-space: nowrap;">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
          <line x1="4" y1="21" x2="4" y2="14"></line>
          <line x1="4" y1="10" x2="4" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12" y2="3"></line>
          <line x1="20" y1="21" x2="20" y2="16"></line>
          <line x1="20" y1="12" x2="20" y2="3"></line>
        </svg>
        Schools
      </button>
      <a href="#" id="refreshBtn" class="btn btn-secondary" style="font-family: var(--font-main); white-space: nowrap;">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
          <polyline points="23 4 23 10 17 10"></polyline>
          <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
        </svg>
        Refresh
      </a>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-container">
    <div class="filter-grid infra-filter-grid">
      <div class="filter-item">
        <label>DATE</label>
        <input type="date" id="dateFilter" class="filter-input">
      </div>
      <div class="filter-item">
        <label>BUILDING</label>
        <select id="buildingFilter" class="filter-select">
          <option value="all">All Buildings</option>
        </select>
      </div>
      <div class="filter-item">
        <label>FLOOR</label>
        <select id="floorFilter" class="filter-select">
          <option value="all">All Floors</option>
        </select>
      </div>
      <div class="filter-item">
        <label>CLASS</label>
        <select id="classFilter" class="filter-select">
          <option value="all">All Classes</option>
        </select>
      </div>
      <div class="filter-item">
        <label>CATEGORY</label>
        <select id="categoryFilter" class="filter-select">
          <option value="all">All Categories</option>
        </select>
      </div>
    </div>
    <div class="filter-toggles">
      <label class="toggle-label">
        <input type="checkbox" id="showAvailable" checked> Show Available
      </label>
      <label class="toggle-label">
        <input type="checkbox" id="showOccupied" checked> Show Occupied
      </label>
      <button id="clearFiltersBtn" class="clear-filters-btn">Clear Filters</button>
    </div>
  </div>

  <!-- Statistics Cards -->
  <div class="class-cards-grid" style="margin-bottom:24px">
    <div class="class-card">
      <div class="card-subject">
        <span class="subject-badge" style="background:#1e293b">ALL</span>
        <div class="subject-name">Total Rooms</div>
      </div>
      <div class="card-info">
        <div class="card-info-row">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
          <span style="font-size:1.25rem;font-weight:700;color:var(--text-primary)" id="totalRooms">0</span>
        </div>
      </div>
    </div>
    <div class="class-card">
      <div class="card-subject">
        <span class="subject-badge" style="background:#ef4444">OCC</span>
        <div class="subject-name">Occupied</div>
      </div>
      <div class="card-info">
        <div class="card-info-row">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
          <span style="font-size:1.25rem;font-weight:700;color:#ef4444" id="occupiedRooms">0</span>
        </div>
      </div>
    </div>
    <div class="class-card">
      <div class="card-subject">
        <span class="subject-badge" style="background:var(--success-color)">FREE</span>
        <div class="subject-name">Available</div>
      </div>
      <div class="card-info">
        <div class="card-info-row" style="color:var(--success-color)">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>
          <span style="font-size:1.25rem;font-weight:700" id="availableRooms">0</span>
        </div>
      </div>
    </div>
    <div class="class-card">
      <div class="card-subject">
        <span class="subject-badge" style="background:#3b82f6">RATE</span>
        <div class="subject-name">Occupancy Rate</div>
      </div>
      <div class="card-info">
        <div class="card-info-row">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
          <span style="font-size:1.25rem;font-weight:700;color:#3b82f6" id="occupancyRate">0%</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Gantt Chart -->
  <div id="ganttChart" class="gantt-container">
    <!-- Gantt chart will be rendered here -->
  </div>

  <div id="loading" class="loading-state" style="display: none;">
    <div class="spinner"></div>
    <p>Loading room data...</p>
  </div>

  <div id="noData" class="empty-state" style="display: none;">
    <div class="empty-icon">ðŸ“Š</div>
    <h3>No rooms found</h3>
    <p>Try adjusting your filters to see more results</p>
  </div>
</div>

<script src="/js/infra-dashboard.js"></script>
</body>
</html>
